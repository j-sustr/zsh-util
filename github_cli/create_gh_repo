# create_gh_repo: specific automation for j-sustr repo creation
#
# Usage: create_gh_repo
#

__create_gh_repo() {
    local repo_root
    local repo_name

    if git rev-parse --is-inside-work-tree >/dev/null 2>&1; then
        repo_root=$(git rev-parse --show-toplevel)
        repo_name=$(basename "$repo_root")
        
        # Ensure we are running from the root because --source=. uses current dir
        if [[ "$PWD" != "$repo_root" ]]; then
            echo "Moving to repo root: $repo_root"
            cd "$repo_root" || return 1
        fi
    else
        repo_name=$(basename "$PWD")
    fi

    echo "Creating private repo: j-sustr/$repo_name"
    gh repo create "j-sustr/$repo_name" --private --source=. --remote=origin --push
}

__create_gh_repo "$@"
